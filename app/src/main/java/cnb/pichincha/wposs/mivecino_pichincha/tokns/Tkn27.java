package cnb.pichincha.wposs.mivecino_pichincha.tokns;

import newpos.libpay.trans.pichincha.Administrativas.InitTrans;
import newpos.libpay.utils.ISOUtil;

import static newpos.libpay.utils.ISOUtil.formatMiles;

public class Tkn27 {

    private byte[] cedula = new byte[8];
    private byte[] beneficiario = new byte[] {0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,
            0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,
            0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,
            0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20};
    private byte[] dactilar = new byte[10];
    private byte[] fechaCedula = new byte[10];
    private byte[] remesa = new byte[]{0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,
            0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20};
    private byte[] montoRemesa = new byte[]{0x00,0x00,0x00,0x00,0x00,0x00};
    private byte[] formaPago = new byte[]{0x00};
    private byte[] celular = new byte[6];
    private byte[] otp = new byte[6];
    private byte[] IdTransaccion = new byte[]{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00};
    private byte[] ordenante = new byte[]{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
            0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
            0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
            0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00};
    private byte[] direccion = new byte[]{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
            0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
            0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
            0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00};
    private byte[] estadoRemesa = new byte[]{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
            0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
            0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
            0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00};
    private byte[] fechaEnvio = new byte[10];

    public byte[] getCedula() {
        return cedula;
    }

    public void setCedula(byte[] cedula) {
        this.cedula = cedula;
    }

    public byte[] getBeneficiario() {
        return beneficiario;
    }

    public void setBeneficiario(byte[] beneficiario) {
        this.beneficiario = beneficiario;
    }

    public byte[] getDactilar() {
        return dactilar;
    }

    public void setDactilar(byte[] dactilar) {
        this.dactilar = dactilar;
    }

    public byte[] getFechaCedula() {
        return fechaCedula;
    }

    public void setFechaCedula(byte[] fechaCedula) {
        this.fechaCedula = fechaCedula;
    }

    public byte[] getRemesa() {
        return remesa;
    }

    public void setRemesa(byte[] remesa) {
        this.remesa = remesa;
    }

    public byte[] getMontoRemesa() {
        return montoRemesa;
    }

    public void setMontoRemesa(byte[] montoRemesa) {
        this.montoRemesa = montoRemesa;
    }

    public byte[] getFormaPago() {
        return formaPago;
    }

    public void setFormaPago(byte[] formaPago) {
        this.formaPago = formaPago;
    }

    public byte[] getCelular() {
        return celular;
    }

    public void setCelular(byte[] celular) {
        this.celular = celular;
    }

    public byte[] getOtp() {
        return otp;
    }

    public void setOtp(byte[] otp) {
        this.otp = otp;
    }

    public byte[] getIdTransaccion() {
        return IdTransaccion;
    }

    public void setIdTransaccion(byte[] idTransaccion) {
        IdTransaccion = idTransaccion;
    }

    public byte[] getOrdenante() {
        return ordenante;
    }

    public void setOrdenante(byte[] ordenante) {
        this.ordenante = ordenante;
    }

    public byte[] getDireccion() {
        return direccion;
    }

    public void setDireccion(byte[] direccion) {
        this.direccion = direccion;
    }

    public byte[] getEstadoRemesa() {
        return estadoRemesa;
    }

    public void setEstadoRemesa(byte[] estadoRemesa) {
        this.estadoRemesa = estadoRemesa;
    }

    public byte[] getFechaEnvio() {
        return fechaEnvio;
    }

    public void setFechaEnvio(byte[] fechaEnvio) {
        this.fechaEnvio = fechaEnvio;
    }

    public String packTkn27(){
        StringBuilder tkn27 = new StringBuilder();
        tkn27.append("270246");
        tkn27.append(ISOUtil.bcd2str(cedula, 0, cedula.length));
        tkn27.append(ISOUtil.bcd2str(beneficiario,0,beneficiario.length));
        tkn27.append(ISOUtil.bcd2str(dactilar, 0, dactilar.length));
        tkn27.append(ISOUtil.bcd2str(fechaCedula,0,fechaCedula.length));
        tkn27.append(ISOUtil.bcd2str(remesa,0,remesa.length));
        tkn27.append(ISOUtil.bcd2str(montoRemesa,0,montoRemesa.length));
        tkn27.append(ISOUtil.bcd2str(formaPago,0,formaPago.length));
        tkn27.append(ISOUtil.bcd2str(celular,0,celular.length));
        tkn27.append(ISOUtil.bcd2str(otp,0,otp.length));
        tkn27.append(ISOUtil.bcd2str(IdTransaccion,0,IdTransaccion.length));
        tkn27.append(ISOUtil.bcd2str(ordenante,0,ordenante.length));
        tkn27.append(ISOUtil.bcd2str(direccion,0,direccion.length));
        tkn27.append(ISOUtil.bcd2str(estadoRemesa,0,estadoRemesa.length));
        tkn27.append(ISOUtil.bcd2str(fechaEnvio,0,fechaEnvio.length));
        return tkn27.toString();
    }

    public void clean(){
        cedula = new byte[] {(byte) 0xFF,(byte) 0xFF,(byte) 0xFF,(byte) 0xFF,(byte) 0xFF,(byte) 0xFF,(byte) 0xFF,(byte) 0xFF};
        beneficiario = new byte[] {0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,
                0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,
                0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,
                0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20};
        dactilar = new byte[]{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00};
        fechaCedula = new byte[]{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00};
        remesa = new byte[]{0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,
                0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20};
        montoRemesa = new byte[]{0x00,0x00,0x00,0x00,0x00,0x00};
        formaPago = new byte[]{0x00};
        celular = new byte[] {(byte) 0xFF,(byte) 0xFF,(byte) 0xFF,(byte) 0xFF,(byte) 0xFF,(byte) 0xFF};
        otp = new byte[] {(byte) 0xFF,(byte) 0xFF,(byte) 0xFF,(byte) 0xFF,(byte) 0xFF,(byte) 0xFF};
        IdTransaccion = new byte[]{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00};
        ordenante = new byte[]{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
                0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
                0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
                0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00};
        direccion = new  byte[] {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
                0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
                0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
                0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00};
        estadoRemesa = new byte[] {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
                0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
                0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
                0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00};
        fechaEnvio = new byte[] {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00};

    }

    /**
     * Este método nos permitira saber si el campo dirección viene relleno de espacios (20) o de
     * F, si es así retornaremos true.
     * Uso de operador ternario, nos permite expresar una sentencia if en una sola línea.
     * **/
    public boolean direccion() {
        String varf = "FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF";
        String var20 = "20202020202020202020202020202020202020202020202020202020202020202020202020202020";
        String direc2 = ISOUtil.byte2hex(getDireccion()).trim();
        return direc2.equals(varf) || direc2.equals(var20) ? true : false;
    }

    /**
     * Obtenemos el monto de la remesa, usaremos ese dato para validar el tipo de pago que le
     * mostraremos al usuario.
     * **/
    public String montoRemesa() {
        return formatMiles(Integer.parseInt(ISOUtil.bcd2str(InitTrans.tkn27.getMontoRemesa(),0,
                InitTrans.tkn27.getMontoRemesa().length)));
    }
}
